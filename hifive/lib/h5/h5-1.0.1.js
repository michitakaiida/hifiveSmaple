/* Copyright (C) 2012 NS Solutions Corporation, All Rights Reserved. Licensed under the Apache License, Version 2.0. hifive version 1.0.1 (util,controller,view,ui,api.geo,api.sqldb,api.storage) */
(function(b){function n(b,k,g){var o=Error();b&&(o.code=b);if(b=Q[b])k=[b].concat(k),o.message=e.u.str.format.apply(null,k);g&&(o.detail=g);throw o;}function L(b){for(code in b)b.hasOwnProperty(code)&&(Q[code]=b[code])}function J(b,k,g){var o=null,l=Q[b];l&&(k=[l].concat(k),o=e.u.str.format.apply(null,k));return{code:b,message:o,detail:g}}function w(e){return!e?e:b.isArray(e)?e:[e]}function M(b){var e=document.createElement("span");e.innerHTML='<a href="'+b+'" />';return e.firstChild.href}function N(e){if("regexp"===
b.type(e))return e;var k="",k=-1!==e.indexOf("*")?b.map(e.split("*"),function(b){return b.replace(/\W/g,"\\$&")}).join(".*"):e;return RegExp("^"+k+"$")}var U=void 0;if(window.h5){if(window.h5.env&&"1.0.1"===window.h5.env.version)return;U=window.h5}var e={};window.h5=e;e.coexist=function(){window.h5=U;return e};e.env={version:"1.0.1"};var Q={};(function(){function q(b){switch(b){case "string":return"s";case "number":return"n";case "boolean":return"b";case "String":return"S";case "Number":return"N";
case "Boolean":return"B";case "infinity":return"i";case "-infinity":return"I";case "nan":return"x";case "date":return"d";case "regexp":return"r";case "array":return"a";case "object":return"o";case "function":return"f";case "null":return"l";case k:return"u";case "undefElem":return"_";case "objElem":return"@"}}var k="undefined",g=11005,o=11006,l={11E3:"{0} 第一引数には空文字で無い文字列を指定して下さい。",11001:'名前空間"{0}"には、プロパティ"{1}"が既に存在します。',11002:"Function型のオブジェクトは変換できません。",11003:"シリアライザのバージョンが違います。シリアライズされたバージョン：{0} 現行のバージョン：{1}",
11004:"型情報の判定に失敗したため、デシリアライズできませんでした。"};l[g]="循環参照が含まれています。";l[o]="不正な値が含まれるため、デシリアライズできませんでした。";L(l);var u=[],s={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;","'":"&apos;"},t=function(c){c||n(11E3,"h5.u.obj.ns()");"string"!==b.type(c)&&n(11E3,"h5.u.obj.ns()");for(var c=c.split("."),i=window,f=0,e=c.length;f<e;f++)void 0===i[c[f]]&&(i[c[f]]={}),i=i[c[f]];return i},l=function(b,i){var f=t(b),e;for(e in i)i.hasOwnProperty(e)&&(f[e]&&n(11001,b,e),f[e]=i[e])};l("h5.u",{loadScript:function(c,i){var f=
w(c);if(0!==f.length){var g=i&&!0===i.force,h=f.length;if(!i||!0!==i.async)for(var d=b("head"),a=0;a<h;a++){var A=M(f[a]);if(g||-1===b.inArray(A,u))d.append('<script type="text/javascript" src="'+A+'"><\/script>'),u.push(A)}else{var k=i&&!0===i.parallel,m=[],z=e.async.deferred(),o=document.head||document.getElementsByTagName("head")[0],D=function(a){var c=a;if(h<=c)b.when.apply(b,m).done(function(){z.resolve()});else if(a=M(f[c]),!g&&-1!==b.inArray(a,u))D(++c);else{var d=document.createElement("script");
d.type="text/javascript";var j=k?e.async.deferred():null;window.ActiveXObject?d.onreadystatechange=function(){if("complete"==d.readyState||"loaded"==d.readyState)d.onreadystatechange=null,j?j.resolve():D(++c)}:(d.onerror=function(){d.onerror=null;j?j.resolve():D(++c)},d.onload=function(){d.onload=null;j?j.resolve():D(++c)});d.src=a;o.appendChild(d);u.push(a);j&&(m.push(j.promise()),D(++c))}};setTimeout(function(){D(0)},0);return z.promise()}}},createInterceptor:function(b,i){return function(f){var g=
{},h=b?b.call(this,f,g):f.proceed();f.result=h;if(!i)return h;if(e.async.isPromise(h)){var d=this;h.always(function(){i.call(d,f,g)});return h}i.call(this,f,g);return h}}});l("h5.u.str",{startsWith:function(b,i){return 0===b.lastIndexOf(i,0)},endsWith:function(b,i){var f=b.length-i.length;return 0<=f&&b.lastIndexOf(i)===f},format:function(b,i){if(null==b)return"";var f=arguments;return b.replace(/\{(\d+)\}/g,function(b,c){var d=f[parseInt(c,10)+1];return typeof d===k?k:d})},escapeHtml:function(c){return"string"!==
b.type(c)?c:c.replace(/[&"'<>]/g,function(b){return s[b]})}});l("h5.u.obj",{expose:l,ns:t,serialize:function(c){function i(b){for(var a=0,c=h.length;a<c;a++)if(b===h[a])return!0;return!1}function f(b){for(var a=0,c=h.length;a<c;a++)b===h[a]&&h.splice(a,1)}function e(d){var a=d,c=b.type(d);"object"===typeof d&&(d instanceof String?c="String":d instanceof Number?c="Number":d instanceof Boolean&&(c="Boolean"));switch(c){case "String":case "string":a=q(c)+a;break;case "Boolean":a=a.valueOf();case "boolean":a=
q(c)+(a?1:0);break;case "Number":a=a.valueOf();if(b.isNaN&&b.isNaN(d)||b.isNumeric&&!b.isNumeric(d))a=Infinity===d.valueOf()?q("infinity"):-Infinity===d.valueOf()?q("-infinity"):q("nan");a=q(c)+a;break;case "number":a=b.isNaN&&b.isNaN(d)||b.isNumeric&&!b.isNumeric(d)?Infinity===d?q("infinity"):-Infinity===d?q("-infinity"):q("nan"):q(c)+a;break;case "regexp":a=q(c)+a.toString();break;case "date":a=q(c)+ +a;break;case "array":i(d)&&n(g);h.push(d);for(var o=[],a=q(c)+"[",c=0,m=d.length;c<m;c++){o[c.toString()]=
!0;var z;z=d.hasOwnProperty(c)?"function"===b.type(d[c])?q(k):e(d[c]).replace(/\\/g,"\\\\").replace(/"/g,'\\"'):q("undefElem");a+='"'+z+'"';c!==d.length-1&&(a+=",")}var c="",l;for(l in d)o[l]||"function"!==b.type(d[l])&&(c+='"'+l+'":"'+e(d[l]).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'",');c&&(a+=(d.length?",":"")+'"@{'+c.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),a=a.replace(/,$/,""),a+='}"');a+="]";f(d);break;case "object":i(d)&&n("循環参照が含まれています。");h.push(d);a=q(c)+"{";for(l in d)d.hasOwnProperty(l)&&
"function"!==b.type(d[l])&&(a+='"'+l+'":"'+e(d[l]).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'",');a=a.replace(/,$/,"");a+="}";f(d);break;case "null":case k:a=q(c)}return a}b.isFunction(c)&&n(11002);var h=[];return"1|"+e(c)},deserialize:function(c){function e(c){function h(b){switch(b){case "s":return"string";case "n":return"number";case "b":return"boolean";case "S":return"String";case "N":return"Number";case "B":return"Boolean";case "i":return"infinity";case "I":return"-infinity";case "x":return"nan";
case "d":return"date";case "r":return"regexp";case "a":return"array";case "o":return"object";case "f":return"function";case "l":return"null";case "u":return k;case "_":return"undefElem";case "@":return"objElem"}}try{if(c.match(/^(.)(.*)/),type=RegExp.$1,f=RegExp.$2?RegExp.$2:"",void 0!==type&&""!==type)switch(c=f,h(type)){case "String":f=new String(f);break;case "Boolean":"0"===f||"1"===f?f=new Boolean("1"===f):n(o);break;case "boolean":"0"===f||"1"===f?f="1"===f:n(o);break;case "Number":f="infinity"===
h(f)?new Number(Infinity):"-infinity"===h(f)?new Number(-Infinity):"nan"===h(f)?new Number(NaN):new Number(f);break;case "number":f=parseFloat(f);break;case "array":for(var d=b.parseJSON(f),c=0;c<d.length;c++)if(d[c].match(RegExp("^"+q("undefElem"))))delete d[c];else if(d[c].match(RegExp("^"+q("objElem")))){for(var a=e(d[c].replace(RegExp("^"+q("objElem")),q("object"))),g=[],c=0,l=d.length-1;c<l;c++)g[c]=d[c];var d=g,m;for(m in a)d[m]=a[m]}else d[c]=e(d[c]);f=d;break;case "object":d=b.parseJSON(f);
for(m in d)d[m]=e(d[m]);f=d;break;case "date":f=new Date(parseInt(c,10));break;case "regexp":c.match(/^\/(.*)\/(.*)$/);f=RegExp(RegExp.$1,RegExp.$2);break;case "null":case "function":f=null;break;case k:f=void 0;break;case "nan":f=NaN;break;case "infinity":f=Infinity;break;case "-infinity":f=-Infinity}}catch(z){}return f}if("string"!==typeof c)return c;c.match(/^(.)\|(.*)/);c=RegExp.$1;"1"!==c&&n(11003,[c,"1"]);var f=RegExp.$2;return e(f)},isJQueryObject:function(c){return!c||!c.jquery?!1:c.jquery===
b().jquery},argsToArray:function(b){return Array.prototype.slice.call(b)},getByPath:function(b){"string"!==typeof b&&n(11E3,"h5.u.obj.getByPath()");b=b.split(".");"window"===b[0]&&b.unshift();for(var e=window,f=0,g=b.length;f<g&&!(e=e[b[f]],null==e);f++);return e}})})();(function(){var q,k,g,o,l,u,s;function t(a,c){var d={};if(b.isArray(a)){var h=a.slice(0,3).join(" <- ");0<a.slice(3).length&&(h+=" ...");d.recent=h;d.all=c.join("\n")}else d.recent=a,d.all=c;return d}function c(b){var a="";b.name?
a=b.name:(/^\s*function\s*([\w\-\$]+)?\s*\(/i.test(b.toString()),a=RegExp.$1);return a}function i(a){for(var a=e.u.obj.argsToArray(a),c=[],d=0,h=a.length;d<h;d++)c.push(b.type(a[d]));return c.join(", ")}function f(){}function r(a){(null==a||0===b.trim(a).length)&&n(m);this.category=b.trim(a)}var h=10001,d=10002,a=10003,A=10003,E=10004,m=10005,z={1E4:'ログターゲットのtypeには、オブジェクト、もしくは"console"のみ指定可能です。'};z[h]="out.categoryは必須項目です。";z[d]='category"{0}"が複数回指定されています。';z[a]='level"{0}"の指定は不正です。Number、もしくはtrace, info, debug, warn, errorを指定してください。';
z[A]='ログターゲット"{0}"が複数回指定されています。';z[E]='"{0}"という名前のログターゲットはありません。';z[m]="categoryは必須項目です。1文字以上の文字列を指定してください。";L(z);q=50;k=40;g=30;o=20;l=10;u=0;s=-1;var B=null;f.prototype={init:function(){},log:function(b){window.console&&("string"!==typeof b.args[0]?this._logObj(b):this._logMsg(b))},_logMsg:function(b){var a=b.args,c=null,c=1===a.length?a[0]:e.u.str.format.apply(e.u.str,a),a=this._getLogPrefix(b)+c;b.logger.enableStackTrace&&(a+="  ["+b.stackTrace.recent+"]");b.logger.enableStackTrace&&console.groupCollapsed?
console.groupCollapsed(a):this._consoleOut(b.level,a);b.logger.enableStackTrace&&this._consoleOut(b.level,b.stackTrace.all);b.logger.enableStackTrace&&console.groupEnd&&console.groupEnd()},_consoleOut:function(b,a){var c=!1;b==q&&console.error?(console.error(a),c=!0):b==k&&console.warn?(console.warn(a),c=!0):b==g&&console.info?(console.info(a),c=!0):b==o&&console.debug&&(console.debug(a),c=!0);!c&&console.log&&console.log(a)},_getLogPrefix:function(b){return"["+b.levelString+"]"+b.date.getHours()+
":"+b.date.getMinutes()+":"+b.date.getSeconds()+","+b.date.getMilliseconds()+": "},_logObj:function(b){var a=b.args,c=this._getLogPrefix(b);a.unshift(c);b.level==q&&console.error?this._output(console.error,a):b.level==k&&console.warn?this._output(console.warn,a):b.level==g&&console.info?this._output(console.info,a):b.level==o&&console.debug?this._output(console.debug,a):this._output(console.log,a)},_output:function(a,c){if("undefined"!==typeof a.apply)a.apply(console,c);else{var d="",d=b.isArray(c)?
d+c.join(" "):d+c.toString();a(d)}}};r.prototype={enableStackTrace:!1,maxStackSize:10,error:function(b){this._log(q,arguments,this.error)},warn:function(b){this._log(k,arguments,this.warn)},info:function(b){this._log(g,arguments,this.info)},debug:function(b){this._log(o,arguments,this.debug)},trace:function(b){this._log(l,arguments,this.trace)},_traceFunctionName:function(a){var d=Error(),h=d.stack||d.stacktrace,d={},e=[];if(h)var e=h.replace(/\r\n/,"\n").replace(/at\b|@|Error\b|\t|\[arguments not available\]/ig,
"").replace(/(http|https|file):.+[0-9]/g,"").replace(/ +/g," ").split("\n"),j=null,e=b.map(e,function(a){return j=0===a.length?null:""===b.trim(a)?"{anonymous}":b.trim(a)}),d=t(e.slice(3,e.length),e.slice(0,this.maxStackSize));else if(a=a.caller,h=0,a)for(;;){var f=i(a.arguments),g=c(a);g?e.push("{"+g+"}("+f+")"):a.caller?e.push("{anonymous}("+f+")"):e.push("{root}("+f+")");if(!a.caller||h>=this.maxStackSize){d=t(e,e);break}a=a.caller;h++}else t("{unable to trace}","{unable to trace}");return d},
_log:function(b,a,c){var a={level:b,args:e.u.obj.argsToArray(a),stackTrace:this.enableStackTrace?this._traceFunctionName(c):""},d=B.out,j=B.defaultOut,c=null;if(d)for(var d=w(d),h=0,f=d.length;h<f;h++){var g=d[h];if(g.compiledCategory.test(this.category)){c=g;break}}c||(c=j);h=c.compiledLevel;c=c.compiledTargets;if(!(b<h||0>h))if(a.logger=this,a.date=new Date,a.levelString=this._levelToString(b),c&&0!==c.length){h=0;for(f=c.length;h<f;h++)c[h].log(a)}},_levelToString:function(b){return b===q?"ERROR":
b===k?"WARN":b===g?"INFO":b===o?"DEBUG":b===l?"TRACE":b===u?"ALL":b===s?"NONE":"OTHER"}};e.u.obj.expose("h5.log",{createLogger:function(a){return new r(b.trim(a))},configure:function(){function c(j,e,f){var v=null==f;if(!v){var m=b.trim(e.category);0===m.length&&!f&&n(h);-1!==b.inArray(m,z)&&n(d,e.category);e.compiledCategory=N(m)}m=b.trim(e.level);0===m.length&&(m=v?i.level:f.level);var F="number"===b.type(m)?m:m.match(/^error$/i)?q:m.match(/^warn$/i)?k:m.match(/^info$/i)?g:m.match(/^debug$/i)?o:
m.match(/^trace$/i)?l:m.match(/^all$/i)?u:m.match(/^none$/i)?s:null;null==F&&n(a,m);e.compiledLevel=F;var m=[],p=e.targets;if(!v&&!p)m=f.compiledTargets;else if(!v||p){for(var F=[],p=w(p),B=0,D=p.length;B<D;B++){var r=p[B];if(r){-1!==b.inArray(r,F)&&n(A,r);var t=j[r];t||n(E,r);F.push(r);m.push(t.compiledTarget)}}if(!v&&(j=f.targets,null!=j)){j=w(j);B=0;for(D=j.length;B<D;B++)r=j[B],-1===b.inArray(r,F)&&(m.push(f.compiledTargets[B]),F.push(r))}}e.compiledTargets=m}var i={level:"NONE",targets:null},
z=[];B=b.extend(!0,{},e.settings.log?e.settings.log:{defaultOut:i});var m=B.target;m||(m={},B.target=m);(function(a){for(var c in a){var d=a[c],j=b.type(d.type);(j==="object"||j==="string"&&d.type!=="console")&&n(1E4);j=null;j=d.type==="console"?new f:b.extend(true,{},d.type);j.init&&j.init(d);d.compiledTarget=j}a.console={type:"console",compiledTarget:new f}})(m);var j=B.defaultOut;j||(j=i,B.defaultOut=j);c(m,j);var v=B.out;if(v)for(var v=w(v),p=0,F=v.length;p<F;p++)c(m,v[p],j)}})})();(function(){function q(g){e.settings.aspects=
b.map(w(g),function(b){b.target&&(b.compiledTarget=N(b.target));b.pointCut&&(b.compiledPointCut=N(b.pointCut));return b})}e.u.obj.ns("h5.settings");e.settings={commonFailHandler:null,aspects:null,log:null};var k=e.u.createInterceptor(function(b,e){e.start=new Date;return b.proceed()},function(b,e){this.log.info('{0} "{1}": {2}ms',this.__name,b.funcName,new Date-e.start)}),g=e.u.createInterceptor(function(b){this.log.info('{0} "{1}"が開始されました。',this.__name,b.funcName);this.log.info(b.args);return b.proceed()},
function(b){this.log.info('{0} "{1}"が終了しました。',this.__name,b.funcName)});e.u.obj.expose("h5.core.interceptor",{lapInterceptor:k,logInterceptor:g,errorInterceptor:function(g){var k=null;try{k=g.proceed()}catch(q){e.settings.commonFailHandler&&b.isFunction(e.settings.commonFailHandler)&&e.settings.commonFailHandler.call(null,q)}return k}});b(window.document).trigger("h5preinit");e.settings.aspects&&q(e.settings.aspects);e.log.configure()})();(function(){e.u.obj.expose("h5.env",{ua:function(e){var k=
!!e.match(/iPhone/i),g=!!e.match(/iPad/i),o=k||g,l=!!e.match(/android/i),n=!!e.match(/Windows Phone/i),s=!!e.match(/MSIE/),t=!!e.match(/Firefox/i),c=!!e.match(/Chrome/i)||!!e.match(/CrMo/),i=!l&&!!e.match(/Safari/i)&&!c,f=!!e.match(/Webkit/i),r=!!e.match(/Opera/i),h=l&&!!e.match(/Safari/i)&&!c,d=!(!k&&!n&&!(h&&e.match(/Mobile/)&&!e.match(/SC-01C/)||l&&c&&e.match(/Mobile/)||e.match(/Fennec/i)||e.match(/Opera Mobi/i))),a=!(!g&&!(h&&!e.match(/Mobile/)||l&&c&&!e.match(/Mobile/)||e.match(/SC-01C/)||e.match(/Fennec/i)||
e.match(/Opera Tablet/i))),A=!d&&!a,E=null,m=null,z=function(a,c){return b.trim(e.substring(e.indexOf(a)+a.length,e.indexOf(c))).split("_")},B=function(a,c){var d=b.trim(e.match(!1===c?RegExp(a+"[^;)]*"):RegExp(a+"[^;)]*","i"))).split(" ");return d[d.length-1]},D=function(a,c){var d=b.trim(e.match(!1===c?RegExp(a+"[^;) ]*"):RegExp(a+"[^;) ]*","i"))).split("/");return d[d.length-1]};if(k)m=z("iPhone OS","like"),E=parseInt(m[0]),m=m.join(".");else if(g)m=z("CPU OS","like"),E=parseInt(m[0]),m=m.join(".");
else if(!l||!t)l?(m=B("Android"),E=parseInt(m.split(".")[0])):n&&((m=B("Windows Phone OS"))||(m=B("Windows Phone")),E=parseInt(m.split(".")[0]));var K=z=null;if(o||l&&h)z=E,K=m;else{var x=null;s?x=B("MSIE",!1):c?(x=D("Chrome",!1))||(x=D("CrMo",!1)):i?x=D("Version"):t?x=D("Firefox"):r&&((x=D("Version"))||(x=D("Opera")),x||(x=B("Opera")));x&&(z=parseInt(x.split(".")[0]),K=x)}return{osVersion:E,osVersionFull:m,browserVersion:z,browserVersionFull:K,isiPhone:k,isiPad:g,isiOS:o,isAndroid:l,isWindowsPhone:n,
isIE:s,isFirefox:t,isChrome:c,isSafari:i,isOpera:r,isAndroidDefaultBrowser:h,isSmartPhone:d,isTablet:a,isDesktop:A,isWebkit:f}}(navigator.userAgent)})})();(function(){L({5E3:"h5.async.each() の第1引数は配列のみを扱います。"});var q=function(){var g=b.Deferred();if(!g.notify&&!g.notifyWith&&!g.progress){var k=!1,l=null,n=null;g.__h5__progressCallbacks=[];g.__h5__progressFilters=[];var q=function(b){var a=this.__h5__progressPipeFilters;if(k){var c=n;if(a&&0<a.length)for(var d=0,e=a.length;d<e;d++)c=a[d].apply(this,
w(c));c!==n&&(c=w(c));b.apply(l,c)}g.__h5__progressCallbacks.push(b);g.__h5__progressFilters.push(a);return this};g.progress=q;var t=g.promise;g.promise=function(b){b=t.call(this,b);b.progress=q;return b};g.notify=function(){k=!0;-1!==arguments.length&&(l=this,n=e.u.obj.argsToArray(arguments));var b=g.__h5__progressCallbacks,a=g.__h5__progressFilters,c=e.u.obj.argsToArray(arguments);if(0<b.length)for(var d=0,h=b.length;d<h;d++){var f=c;if(a[d]&&0<a[d].length)for(var j=0,i=a[d].length;j<i;j++)f=a[d][j].apply(this,
w(f));f!==arguments&&(f=w(f));b[d].apply(this,f)}return this};g.notifyWith=function(b,a){k=!0;l=b;n=a;var c=this.__h5__progressCallbacks,d=this.__h5__progressFilters;if(0<c.length)for(var e=0,h=c.length;e<h;e++){var j=a;if(d[e]&&0<d[e].length)for(var f=0,g=d[e].length;f<g;f++)j=d[e][f].apply(this,w(j));j!==a&&(j=w(j));c[e].apply(b,j)}return this};var c=g.pipe;g.pipe=function(b,a,d){b=c.call(this,b,a);d&&(b.__h5__progressPipeFilters=this.__h5__progressPipeFilters?this.__h5__progressPipeFilters.concat([d]):
[d]);b.pipe=g.pipe;b.progress=g.progress;return b}}var i=!1,f=g.fail,r=function(){0<arguments.length&&(i=!0);return f.apply(this,arguments)};g.fail=r;var h=g.always,d=function(){0<arguments.length&&(i=!0);return h.apply(this,arguments)};g.always=d;var a=function(b,a,c){b&&this.done.apply(this,w(b));a&&this.fail.apply(this,w(a));c&&this.progress.apply(this,w(c));return this};g.then=a;var A=g.reject;g.reject=function(){var b=e.settings.commonFailHandler;!i&&b&&f.call(this,b);return A.apply(this,arguments)};
var E=g.rejectWith;g.rejectWith=function(){var b=e.settings.commonFailHandler;!i&&b&&this.fail(b);return E.apply(this,arguments)};var m=g.promise;g.promise=function(b){b=m.call(this,b);b.always=d;b.then=a;b.fail=r;return b};return g},k=function(b){return!!b&&b.done&&b.fail&&!b.resolve&&!b.reject};e.u.obj.expose("h5.async",{deferred:q,isPromise:k,loop:function(e,o,l){b.isArray(e)||n(5E3);var u=q(),s="number"===b.type(l)?l:20,t=!1,c=0,i=e.length,f,r=null,h=function(){if(c===i)u.resolve(e);else if(t)u.reject(e);
else{var b=o.call(e,c,e[c],r);c++;k(b)?b.done(function(){f()}).fail(function(){t=!0;f()}):f()}},d=function(){setTimeout(function(){var b=c-1;0<c&&u.notify({data:e,index:b,value:e[b]});h()},0)},a=!1;f=function(){a||(0===c%s?d():h())};var A=!1,r={resume:function(){!A&&a&&(a=!1,f())},pause:function(){a=!0},stop:function(){A=!0;u.resolve(e)}};d();return u.promise()}})})();(function(){e.u.obj.expose("h5",{ajax:function(n){var k="string"===typeof arguments[0]?arguments[1]:arguments[0],k=k&&(k.error||k.fail||
k.complete||k.always),g=b.ajax.apply(b,arguments);g.progress||(g.progress=function(){});var o=!1,l=e.settings.commonFailHandler;if(!k&&l){g.fail(function(){o||l.apply(null,arguments)});var u=g.fail;g.fail=function(){o=true;return u.apply(g,arguments)};g.error=g.fail;var s=g.always;g.always=function(){o=true;return s.apply(g,arguments)};g.complete=g.always;g.then=function(b,c,e){b&&g.done.apply(g,w(b));c&&g.fail.apply(g,w(c));e&&g.progress.apply(g,w(e));return g}}return g}})})();(function(){function q(b){return!this.__controllerContext.executeListeners?
void 0:b.proceed()}function k(b,a,c){var d=g(b.__name,a);c&&d.push(q);return o(b[a],a,d)}function g(a,c){var d=[],j=e.settings.aspects;if(!j||0===j.length)return d;for(var j=w(j),h=j.length-1;-1<h;h--){var f=j[h];if(!f.target||f.compiledTarget.test(a)){var i=f.interceptors;if(!f.pointCut||f.compiledPointCut.test(c))if(b.isArray(i))for(f=i.length-1;-1<f;f--)d=d.concat(i[f]);else d.push(i)}}return d}function o(b,a,c){for(var d=function(b,a,y){return function(){var c=this;return y.call(c,{target:c,func:b,
funcName:a,args:arguments,proceed:function(){return b.apply(c,this.args)}})}},e=0,j=c.length;e<j;e++)b=d(b,a,c[e]);return b}function l(b){return!!b.match(/^\{.*\}$/)}function u(b){return!!b.match(/^\[.*\]$/)}function s(a){return b.trim(a.substring(1,a.length-1))}function t(a){return b.trim(a.substring(1,a.length-1))}function c(b){return P(b,"window")||P(b,"document")||P(b,"navigator")?V(b):b}function i(a){var c=function(a,y){for(var d in a)if(0<=b.inArray(a,y)||R(d,Y)&&c(a[d],y.concat([a])))return!0;
return!1};return c(a,[])}function f(a){var c=function(a,y){for(var d in a)if(0<=b.inArray(a,y)||R(d,Z)&&c(a[d],y.concat([a])))return!0;return!1};return c(a,[])}function r(a,c){var d=a[c];return R(c,Y)&&"rootController"!==c&&"parentController"!==c&&!b.isFunction(d)&&d&&!d.__controllerContext.isRoot}function h(a,c,d){var e=[],j=[],h=function(a){j.push(a);for(var y in a)if(r(a,y)){var f=a[y],i=d?f.__controllerContext[c]:f[c];i&&e.push(i);-1===b.inArray(f,j)&&h(f)}};h(a);return e}function d(c){var d=
[],e=function(c){if(!(c.isReady||-1!==b.inArray(c,d))){d.push(c);var y=c.__meta,j={};if(y)for(var h in y)!1===y[h].useHandlers&&(j[h]=1);for(h in c)y=c[h],r(c,h)&&(e(y),j[h]||a(y))}};e(c)}function a(a){var c=a.__controllerContext.bindMap,d;for(d in c)for(var e in c[d]){var j=a,h=d,f=e,i=j.__controllerContext.bindMap[h][f],g=f,m=u(f);m&&(g=t(f));var k=null;switch(g){case "mousewheel":k=p(j,h,g,i);break;case W:case ma:case $:k=F(j,h,f,i);break;default:k=v(j,h,g,i)}if(k)if(b.isArray(k)){j=0;for(h=k.length;j<
h;j++)A(k[j],m)}else A(k,m)}}function A(a,d){d&&(a.eventName="["+a.eventName+"]");var e=a.controller,j=a.selector,h=a.eventName,f=a.handler;e.__controllerContext.unbindMap[j]||(e.__controllerContext.unbindMap[j]={});e.__controllerContext.unbindMap[j][h]=f;var e=a.controller.rootElement,i=a.selector,f=a.eventName,j=a.handler,f=(h=u(f))?t(f):f;if(l(i)){var i=s(i),g=!1;i===na?(i=e,g=!0):i=c(i);g||h||i===document||i===window?b(i).bind(f,j):b(i).live(f,j)}else h?b(i,e).bind(f,j):b(e).delegate(i,f,j)}function E(a){var c=
[],d=function(a){if(-1===b.inArray(a,c)){c.push(a);var y=a.__meta,e={};if(y)for(var j in y)!1===y[j].useHandlers&&(e[j]=1);for(j in a)y=a[j],r(a,j)&&(d(y),e[j]||m(y))}};d(a)}function m(a){var d=a.rootElement,a=a.__controllerContext.unbindMap,e;for(e in a)for(var j in a[e]){var h=a[e][j],f=u(j),i=f?t(j):j;if(l(e)){var g=s(e),m=!1;g===na?(g=d,m=!0):g=c(g);var v=g===document||g===window;m||f||v?b(g).unbind(i,h):b(g).die(i,h)}else f?b(e,d).unbind(i,h):b(d).undelegate(e,i,h)}}function z(a,c){a.__controllerContext.executeListeners=
c;var d=[],e=function(a){d.push(a);for(var y in a)if(r(a,y)){var j=a[y];j.__controllerContext.executeListeners=c;-1===b.inArray(j,d)&&e(j)}};e(a)}function B(a){var c=[],d=function(a,e,y){a.rootController=e;a.parentController=y;c.push(a);for(var j in a)r(a,j)&&(y=a[j],-1===b.inArray(y,c)&&d(y,e,a))};d(a,a,null)}function D(a,c){var d=[],j=c?"isInit":"isReady",f=c?"__init":"__ready",i=H();setTimeout(function(){i.resolve()},0);var g=i.promise(),m=function(a){if(-1===b.inArray(a,d)&&(d.push(a),!a[j])){var y=
!0,i;for(i in a)r(a,i)&&(y=!1,m(a[i]));var v=function(){if(!a[j]){var b=null;a[f]&&(b=a[f]({args:a.__controllerContext.args}));var d=c?x(a):G(a);e.async.isPromise(b)?b.done(function(){d()}):d()}};i=c?K(a):h(a,"readyPromise");c&&y&&i.push(g);b.when.apply(b,i).done(function(){v()})}};m(a)}function K(b){var a=h(b,"initPromise");a.push(b.__controllerContext.templatePromise);return a}function x(b){return function(){if(!b.isInit){b.isInit=!0;var a=b.__controllerContext.initDfd;delete b.__controllerContext.templatePromise;
delete b.__controllerContext.initDfd;a.resolve();b.__controllerContext&&b.__controllerContext.isRoot&&Ia(b)}}}function G(a){return function(){if(!a.isReady){a.isReady=!0;var c=a.__controllerContext.readyDfd;delete a.__controllerContext.readyDfd;c.resolve();a.__controllerContext&&a.__controllerContext.isRoot&&a.rootElement&&a.isInit&&a.isReady&&b(a.rootElement).trigger("h5controllerready",[a])}}}function j(a,d,e){if("string"!==typeof a)return b(a);var j=b.trim(a);l(j)?(a=s(j),e&&!P("window")&&!P("window.")&&
!P("navigator")&&!P("navigator.")&&n(oa),e=b(c(a))):e=b(d).find(a);return e}function v(a,b,c,d){return{controller:a,selector:b,eventName:c,handler:function(){d.call(a,X(a,arguments))}}}function p(a,b,c,d){return{controller:a,selector:b,eventName:typeof document.onmousewheel===pa?"DOMMouseScroll":c,handler:function(){var b=X(a,arguments),c=b.event;c.detail&&(c.wheelDelta=40*-c.detail);d.call(a,b)}}}function F(a,c,d,e){var j=typeof document.ontouchstart!==pa;if(d!==W)return j?v(a,c,d,e):v(a,c,d,function(a){var c=
a.event,d=b(c.currentTarget).offset();c.offsetX=c.pageX-d.left;c.offsetY=c.pageY-d.top;e.apply(this,arguments)});var h=function(a,b){for(var c in a)a.hasOwnProperty(c)&&!b[c]&&"target"!==c&&"currentTarget"!==c&&"originalEvent"!==c&&"liveFired"!==c&&(b[c]=a[c]);b.h5DelegatingEvent=a},f=j?"touchstart":"mousedown",i=j?"touchmove":"mousemove",g=j?"touchend":"mouseup",m=b(document);return function(){var k=null,A=!1,F=function(c,d,e){return function(f){var v;a:{switch(c){case "touchstart":case "mousedown":v=
W;break a;case "touchmove":case "mousemove":v=ma;break a;case "touchend":case "mouseup":v=$;break a}v=void 0}var O=v===W;if(!O||!A){var la=X(a,arguments),p=la.event;j&&Ha(p,c);var l=new b.Event(v);h(p,l);p=p.target;d&&(p=d);e&&e(l);if(!j||A||O)b(p).trigger(l,la.evArg),A=!0;if(O&&A)if(l.isDefaultPrevented())A=!1;else{l.h5DelegatingEvent.preventDefault();var O=l.target,o=l.clientX,n=l.clientY,E=F(i,O,function(a){var b=a.clientX,c=a.clientY;a.dx=b-o;a.dy=c-n;o=b;n=c}),r=F(g,O),z=j?b(O):m;k=function(){z.unbind(i,
E);z.unbind(g,r)};z.bind(i,E);z.bind(g,r)}v===$&&(k(),A=!1)}}},p=[v(a,c,d,e)];p.push({controller:a,selector:c,eventName:f,handler:F(f)});return p}()}function Ha(a,c){var d=a.originalEvent,e="touchend"===c||"touchcancel"===c?d.changedTouches[0]:d.touches[0],j=e.pageX,h=e.pageY;a.pageX=d.pageX=j;a.pageY=d.pageY=h;a.screenX=d.screenX=e.screenX;a.screenY=d.screenY=e.screenY;a.clientX=d.clientX=e.clientX;a.clientY=d.clientY=e.clientY;e=a.target;if(e.ownerSVGElement)e=e.farthestViewportElement;else if(e===
window||e===document)e=document.body;if(e=b(e).offset())h-=e.top,a.offsetX=d.offsetX=j-e.left,a.offsetY=d.offsetY=h}function X(a,c){var d=null,e=null;c&&(d=c[0],e=c[1]);var j=d;if(j&&null==j.offsetX&&null==j.offsetY&&j.pageX&&j.pageY){var h=j.target;if(h.ownerSVGElement)h=h.farthestViewportElement;else if(h===window||h===document)h=document.body;if(h=b(h).offset())j.offsetX=j.pageX-h.left,j.offsetY=j.pageY-h.top}return{controller:a,rootElement:a.rootElement,event:d,evArg:e}}function ea(a){for(var b in a){var c=
a[b];r(a,b)&&(c.rootElement=null,c.view.__controller=null,ea(c))}}function fa(a){var b=a.rootElement,c=a.__meta,d;for(d in a){var e=a[d];r(a,d)&&(e.rootElement=c&&c[d]&&c[d].rootElement?ga(c[d].rootElement,b,e):b,e.view.__controller=e,fa(e))}}function ga(a,c,d){a?d||n(qa):n(ra);a=c?j(a,c):b(a);0===a.length&&n(aa,[d.__name]);1<a.length&&n(ba,[d.__name]);return a.get(0)}function Ia(c){a(c);d(c);var j=e.core.controllerManager.controllers;-1===b.inArray(c,j)&&j.push(c);b(c.rootElement).trigger("h5controllerbound",
[c]);j=h(c,"initPromise");j.push(c.initPromise);b.when.apply(b,j).done(function(){D(c,!1)})}function ha(a){null===a.rootController&&B(a);fa(a);D(a,!0)}function ia(a,b){var c=H();c.resolve();a.__controllerContext.templatePromise=c.promise();a.__controllerContext.initDfd=H();a.initPromise=a.__controllerContext.initDfd.promise();a.__controllerContext.readyDfd=H();a.readyPromise=a.__controllerContext.readyDfd.promise();a.isInit=!1;a.isReady=!1;a.__controllerContext.args=b;for(var d in a)r(a,d)&&ia(a[d])}
function ja(a,c){var d=null,h=c;b.isPlainObject(h)?d=h.target:h={};d=d?j(d,a.rootElement,!0):a.rootElement;return e.ui.indicator.call(a,d,h)}function ka(a,c){var d=[],e=[],j=function(a){e.push(a);for(var h in a)if(r(a,h)){var f=a[h];-1===b.inArray(f,e)&&j(f)}a[c]&&b.isFunction(a[c])&&d.push(a[c]())};j(a);return d}function J(a){var c=[],d=function(a){c.push(a);V("h5.core.view")&&a.view.clear();for(var e in a){if(r(a,e)){var j=a[e];-1===b.inArray(j,c)&&d(j)}a[e]=null}};d(a)}function S(a,b){return b.view.__view.isAvailable(a)?
b.view.__view:b.parentController?S(a,b.parentController):e.core.view}function sa(a){this.__controller=a;V("h5.core.view")&&(this.__view=e.core.view.createView())}function T(a,c,d,j){this.__name=c;this.__templates=null;this.rootElement=a;this.__controllerContext={executeListeners:!0,isRoot:j,bindMap:{},unbindMap:{}};d&&(this.__controllerContext.args=b.extend(!0,{},d));this.isReady=this.isInit=!1;this.readyPromise=this.initPromise=this.parentController=this.rootController=null;this.log=e.log.createLogger(c);
this.view=new sa(this)}function M(){this.rootElement=document;this.controllers=[];b(document).bind("triggerIndicator",function(a,b){b.indicator=ja(this,b).show();a.stopPropagation()})}function Q(a,c,d,e){var j=c.__name;(!j||0===b.trim(j).length)&&n(ta,null,{controllerDefObj:c});d&&!b.isPlainObject(d)&&n(ua,[j],{controllerDefObj:c});c.__controllerContext&&n(va,null,{controllerDefObj:c});if(a){var h=b(a);0===h.length&&n(aa,[j],{controllerDefObj:c});1<h.length&&n(ba,[j],{controllerDefObj:c})}i(c)&&n(wa,
[j],{controllerDefObj:c});f(c)&&n(xa,[j],{controllerDefObj:c});var g=!e||!e.isInternal,h=b.extend(!0,{},c),m=new T(a?b(a).get(0):null,j,d,g),v=c.__templates,A=H(),a=A.promise();m.__controllerContext.templatePromise=a;m.__controllerContext.initDfd=H();m.initPromise=m.__controllerContext.initDfd.promise();m.__controllerContext.readyDfd=H();m.readyPromise=m.__controllerContext.readyDfd.promise();if(v&&0<v.length){var F=function(a){V("h5.core.view");m.view.load(v).then(function(){A.resolve()},function(b){var d=
b.detail.error.status;a===U||0!==d||12029!==d?(b.controllerDefObject=c,A.reject(b)):setTimeout(function(){F(++a)},Ja)})};F(0)}else A.resolve();for(var p in h)if(ca[p])n(ya,[j,p],{controllerDefObj:c});else if(("__ready"===p||"__construct"===p||"__init"===p)&&b.isFunction(h[p]))m[p]=k(h,p);else if(-1!==p.indexOf(" ")&&b.isFunction(h[p])){g=b.trim(p).lastIndexOf(" ");a=b.trim(p.substring(0,g));g=b.trim(p.substring(g+1,p.length));u(g)&&(g="["+b.trim(t(g))+"]");l(a)&&"this"===s(a)&&n(za,[j],{controllerDefObj:c});
var o=m.__controllerContext.bindMap;o[a]||(o[a]={});o[a][g]&&n(Aa,[j,a,g],{controllerDefObj:c});var E=k(h,p,!0);o[a][g]=E;m[p]=E}else R(p,Y)&&h[p]&&!b.isFunction(h[p])?((a=h[p])&&(a=Q(null,b.extend(!0,{},h[p]),d,b.extend({isInternal:!0},e))),m[p]=a):R(p,Z)&&h[p]&&!b.isFunction(h[p])?(a=N(h[p]),m[p]=a):m[p]=b.isFunction(h[p])?k(h,p):h[p];if(d=m.__meta)for(p in d)a=m[p],void 0===a&&n(Ba,[j,p],{controllerDefObj:c}),null===a&&n(Ca,[j,p],{controllerDefObj:c}),T.prototype.constructor!==a.constructor&&n(Da,
[j,p],{controllerDefObj:c});m.__construct&&m.__construct({args:m.__controllerContext.args});if(!m.__controllerContext.isRoot)return m;ha(m);return m}function N(a){var c=a.__name;(!c||0===b.trim(c.length))&&n(Ea,null,{logicDefObj:a});a.__logicContext&&n(Fa,null,{logicDefObj:a});var a=b.extend(!0,{},a),d;for(d in a)a[d]=b.isFunction(a[d])?o(a[d],d,g(a.__name,d)):a[d];a.deferred=H;a.log=e.log.createLogger(c);a.__logicContext={};for(var j in a)a.hasOwnProperty(j)&&R(j,Z)&&(a[j]=N(a[j]));return a}var U=
3,Ja=3E3,pa="undefined",Y="Controller",Z="Logic",W="h5trackstart",ma="h5trackmove",$="h5trackend",na="rootElement",oa=6E3,ra=6001,qa=6002,aa=6003,ba=6004,ta=6006,ua=6007,va=6008,wa=6009,xa=6010,ya=6011,za=6012,Aa=6013,Ba=6014,Ca=6015,Da=6016,Ea=6017,Fa=6018,C={};C[oa]='update/append/prepend() の第1引数に"window", "window.", "navigator", "navigator."で始まるセレクタは指定できません。';C[ra]="バインド対象となる要素を指定して下さい。";C[qa]="コントローラ化したオブジェクトを指定して下さい。";C[aa]='コントローラ"{0}"のバインド対象となる要素が存在しません。';C[ba]='コントローラ"{0}"のバインド対象となる要素が2つ以上存在します。バインド対象は1つのみにしてください。';
C[6005]="エラータイプを指定してください。";C[ta]="コントローラの名前が定義されていません。__nameにコントローラ名を設定して下さい。";C[ua]='コントローラ"{0}"の初期化パラメータがプレーンオブジェクトではありません。初期化パラメータにはプレーンオブジェクトを設定してください。';C[va]="指定されたオブジェクトは既にコントローラ化されています。";C[wa]='コントローラ"{0}"で、参照が循環しているため、コントローラを生成できません。';C[xa]='コントローラ"{0}"のロジックで、参照が循環しているため、ロジックを生成できません。';C[ya]='コントローラ"{0}"のプロパティ"{1}"はコントローラ化によって追加されるプロパティと名前が重複しています。';C[za]='コントローラ"{0}"でセレクタ名にthisが指定されています。コントローラをバインドした要素自身を指定したい時はrootElementを指定してください。';C[Aa]='コントローラ"{0}"のセレクタ"{1}"に対して"{2}"というイベントハンドラが重複して設定されています。';
C[Ba]='コントローラ"{0}"には__metaで指定されたプロパティ"{1}"がありません。';C[Ca]='コントローラ"{0}"の__metaに指定されたキー"{1}"の値がnullです。コントローラを持つプロパティキー名を指定してください。';C[Da]='コントローラ"{0}"の__metaに指定されたキー"{1}"の値はコントローラではありません。コントローラを持つプロパティキー名を指定してください。';C[Ea]="ロジック名が定義されていません。__nameにロジック名を設定して下さい。";C[Fa]="指定されたオブジェクトは既にロジック化されています。";C[6019]="コントローラ、もしくはロジックの __name が設定されていません。";C[6029]="テンプレートはViewモジュールがなければ使用できません。";L(C);e.log.createLogger("h5.core");var H=e.async.deferred,P=e.u.str.startsWith,R=e.u.str.endsWith,Ga=e.u.str.format,da=e.u.obj.argsToArray,
V=e.u.obj.getByPath;b.extend(sa.prototype,{get:function(a,b){return S(a,this.__controller).get(a,b)},update:function(a,b,c){a=j(a,this.__controller.rootElement,!0);S(b,this.__controller).update(a,b,c)},append:function(a,b,c){a=j(a,this.__controller.rootElement,!0);S(b,this.__controller).append(a,b,c)},prepend:function(a,b,c){a=j(a,this.__controller.rootElement,!0);S(b,this.__controller).prepend(a,b,c)},load:function(a){return this.__view.load(a)},register:function(a,b){this.__view.register(a,b)},
isValid:function(a){return this.__view.isValid(a)},isAvailable:function(a){return S(a,this.__controller).isAvailable(a)},clear:function(a){this.__view.clear(a)}});b.extend(T.prototype,{$find:function(a){return b(this.rootElement).find(a)},deferred:function(){return H()},trigger:function(a,c){b(this.rootElement).trigger(a,[c])},own:function(a){var b=this;return function(){a.apply(b,arguments)}},ownWithOrg:function(a){var b=this;return function(){var c=e.u.obj.argsToArray(arguments);c.unshift(this);
a.apply(b,c)}},bind:function(a,c){this.rootElement=ga(a,null,this);this.view.__controller=this;var d=null;c&&(d=b.extend(!0,{},c));ia(this,d);ha(this);return this},unbind:function(){ka(this,"__unbind");m(this);E(this);this.__controllerContext.unbindMap={};var a=this.rootElement;e.core.controllerManager.controllers=b.grep(e.core.controllerManager.controllers,function(b){return b.rootElement!==a});b(this.rootElement).trigger("h5controllerunbound");this.rootElement=null;this.view.__controller=null;ea(this)},
dispose:function(){var a=this.deferred();this.unbind();var c=this,d=ka(this,"__dispose");b.when.apply(b,d).done(function(){J(c);a.resolve()});return a.promise()},triggerIndicator:function(a,c){var d=b.extend(!0,{},a),e=c;if(!e||0===e.length)e="triggerIndicator";b(this.rootElement).trigger(e,[d]);return d.indicator},indicator:function(a){return ja(this,a)},enableListeners:function(){z(this,!0)},disableListeners:function(){z(this,!1)},throwError:function(a,b){var c=null,c=a&&"string"===typeof a?Error(Ga.apply(null,
da(arguments))):Error.apply(null,arguments);c.customType=null;throw c;},throwCustomError:function(a,b,c){null==a&&n(6005);var d=da(arguments);d.shift();error=b&&"string"===typeof b?Error(Ga.apply(null,da(d))):Error.apply(null,d);error.customType=a;throw error;}});b.extend(M.prototype,{getAllControllers:function(){return this.controllers},getController:function(a){for(var a=b(a).get(0),c=this.controllers,d=0,e=c.length;d<e;d++)if(a===c[d].rootElement)return c[d]}});e.u.obj.expose("h5.core",{controllerManager:new M});
var ca={},C=new T(null,"a"),I;for(I in C)C.hasOwnProperty(I)&&"__name"!==I&&"__templates"!==I&&"__meta"!==I&&(ca[I]=1);C=T.prototype;for(I in C)C.hasOwnProperty(I)&&(ca[I]=1);e.u.obj.expose("h5.core",{controller:Q,logic:N,expose:function(a){var b=a.__name;b||n(6019,null,{target:a});var c=b.lastIndexOf(".");if(-1===c)window[b]=a;else{var d=b.substr(0,c),b=b.substr(c+1,b.length),c={};c[b]=a;e.u.obj.expose(d,c)}}})})();(function(){function q(a){return e.u.obj.isJQueryObject(a)?a:b(a)}function k(){this.__cachedTemplates=
{}}var g=7E3,o=7001,l=7002,u=7003,s={};s[g]="テンプレートをコンパイルできませんでした。{0}";s[o]="テンプレートファイルが不正です。{0}";s[l]="テンプレートIDが指定されていません";s[u]="テンプレートファイルを取得できませんでした。";s[7004]="テンプレートファイルが指定されていません。";s[7005]="テンプレートID:{0} テンプレートがありません。";s[7006]="{0} テンプレートにパラメータが設定されていません。";L(s);var t="scriptタグが見つかりません。テンプレート文字列はscriptタグで囲って記述して下さい。",c="構文エラー {0}{1}",i="[";e.log.createLogger("h5.core.view");var f=e.async.deferred,r={escapeHtml:function(a){return e.u.str.escapeHtml(a)}},h={MAX_CACHE:10,cache:{},cacheUrls:[],accessingUrls:[],
append:function(a,b,c){this.cacheUrls.length>=this.MAX_CACHE&&this.deleteCache(this.cacheUrls[0]);this.cache[a]={};this.cache[a].templates=b;this.cache[a].path=c;this.cacheUrls.push(a)},deleteCache:function(a,b){b||delete this.cache[a];for(var c=0,d=this.cacheUrls.length;c<d;c++)if(this.cacheUrls[c]===a){this.cacheUrls.splice(c,1);break}},getTemplateByUrls:function(a){function d(a){if(0!==a.length){var j={},h=[];a.each(function(){var a=b.trim(this.id),d=b.trim(this.innerHTML);null==a&&n(l,null,{});
try{var f=new EJS.Compiler(d,i);f.compile();j[a]=f.process;h.push(a)}catch(m){d=m.lineNumber,n(g,[e.u.str.format(c,d?" line:"+d:"",m.message)],{id:a,error:m})}});return{compiled:j,data:{ids:h}}}}function h(a,c){var j=c||0;if(a.length==j)v.resolve();else{var f=a[j],i=M(f);q.accessingUrls[i]||(q.accessingUrls[i]=e.ajax(f));q.accessingUrls[i].then(function(c,e,f){delete q.accessingUrls[i];c=b(f.responseText).filter(function(){return this.tagName&&-1===this.tagName.indexOf("/")&&8!==this.nodeType});e=
this.url;0<c.not('script[type="text/ejs"]').length&&v.reject(J(o,[t],{url:i,path:e}));f=null;try{f=d(c.filter('script[type="text/ejs"]'))}catch(g){g.detail.url=i,g.detail.path=e,v.reject(g)}try{var p=f.compiled,k=f.data;k.path=e;k.absoluteUrl=i;b.extend(m,p);r.push(k);q.append(i,p,e);h(a,++j)}catch(l){v.reject(J(o,null,{error:l,url:i,path:e}))}}).fail(function(a){v.reject(J(u,null,{url:i,path:f,error:a}))});return v.promise()}}for(var m={},k=[],r=[],q=this,s=function(a){var b=q.cache[a].templates;
q.deleteCache(a,!0);q.cacheUrls.push(a);return b},x=0;x<a.length;x++){var w=a[x],j=M(w);this.cache[j]?(b.extend(m,s(j)),r.push({absoluteUrl:j})):k.push(w)}var v=f(),p=f();b.when(h(k)).done(function(){p.resolve(m,r)}).fail(function(a){p.reject(a)});return p.promise()}};b.extend(k.prototype,{load:function(a){var c=f(),d=this,e=null;switch(b.type(a)){case "string":a||n(7004,[]);e=[a];break;case "array":e=a;0===e.length&&n(7004,[]);break;default:n(7004,[])}h.getTemplateByUrls(e).done(function(a,e){b.extend(d.__cachedTemplates,
a);c.resolve(e)}).fail(function(a){c.reject(a)});return c.promise()},getAvailableTemplates:function(){var a=[],b;for(b in this.__cachedTemplates)a.push(b);return a},register:function(a,d){"string"!==b.type(d)?n(g,["テンプレートには文字列を指定してください"],{id:a}):a||n(l,[]);try{var h=new EJS.Compiler(d,i);h.compile();this.__cachedTemplates[a]=h.process}catch(f){h=f.lineNumber,n(g,[e.u.str.format(c,h?" line:"+h:"",f.message)],{id:a})}},isValid:function(a){try{return(new EJS.Compiler(a,i)).compile(),!0}catch(b){return!1}},
get:function(a,c){var d=this.__cachedTemplates;if(b.isEmptyObject(d))return null;a||n(l);(d=d[a])||n(7005,a);var e=c?b.extend(!0,{},c):{},h=e.hasOwnProperty("_h")?new EJS.Helpers(e):new EJS.Helpers(e,{_h:r}),f=null;try{f=d.call(e,e,h)}catch(i){n(7006,i.toString(),i)}return f},update:function(a,b,c){return q(a).html(this.get(b,c))},append:function(a,b,c){return q(a).append(this.get(b,c))},prepend:function(a,b,c){return q(a).prepend(this.get(b,c))},isAvailable:function(a){return!!this.__cachedTemplates[a]},
clear:function(a){if(void 0===a)this.__cachedTemplates={};else{var c=null;switch(b.type(a)){case "string":c=[a];break;case "array":c=a;break;default:c=[]}for(var a=0,d=c.length;a<d;a++)delete this.__cachedTemplates[c[a]]}}});var d=new k;d.createView=function(){return new k};b(function(){b('script[type="text/ejs"]').each(function(){var a=b.trim(this.id),c=b.trim(this.innerHTML);0!==c.length&&a&&(c=new EJS.Compiler(c,i),c.compile(),d.__cachedTemplates[a]=c.process)})});e.u.obj.expose("h5.core",{view:d})})();
(function(){function n(e){var d={},a;for(a in c){var f=b("<div></div>").addClass(e).addClass(a).appendTo("body"),i=b.camelCase(a);d[i]={};b.map(c[a],function(a){d[i][a]="width"===a||"height"===a?parseInt(f.css(a).replace(/\D/g,""),10):f.css(a)});f.remove()}return d}function k(b,c){var a=window.document.createElement("v:"+b),e;for(e in c)a.style[e]=c[e];return a}function g(b,c){for(var a=[],e=b/2,f=0.8*b/2,i=360/c*Math.PI/180,g=1;g<=c;g++){var k=i*g,l=Math.cos(k),k=Math.sin(k);a.push({from:{x:e+f/
2*l,y:e+f/2*k},to:{x:e+f*l,y:e+f*k}})}return a}function o(c){this.style=b.extend(!0,{},c);c=this.style.throbber.width;this.group=k("group",{width:c+"px",height:this.style.throbber.height+"px"});this.group.className=u;for(var c=g(c,this.style.throbber.lines),d=this.style.throbberLine.color,a=this.style.throbberLine.width,e=0,f=c.length;e<f;e++){var i=c[e],l=i.from,o=i.to,i=k("line");i.strokeweight=a;i.strokecolor=d;i.fillcolor=d;i.from=l.x+","+l.y;i.to=o.x+","+o.y;l=k("stroke");l.opacity=1;i.appendChild(l);
this.group.appendChild(i)}this._createPercentArea()}function l(c,d){b.blockUI.defaults.css={};b.blockUI.defaults.overlayCSS={};this.target=e.u.obj.isJQueryObject(c)?c.get(0):c;var a=this,g=this._isGlobalBlockTarget()?b("body"):b(this.target),k=g.css("position"),m=g.css("zoom"),l=b.extend(!0,{},{message:"",percent:-1,block:!0,promises:null,theme:"a"},d),u={message:e.u.str.format(s,""===l.message?'style="display: none;"':"",l.message),css:{},overlayCSS:{},blockMsgClass:l.theme,showOverlay:l.block,centerX:!1,
centerY:!1,onUnblock:function(){g.css("position",k);g.css("zoom",m);a.throbber.hide()}},D={throbber:{roundTime:1E3,lines:12},throbberLine:{},percent:{}},w=l.promises,x=b.proxy(function(){this.hide()},this);b.isArray(w)?(b.map(w,function(a){return t(a)?a:null}),0<w.length&&b.when.apply(null,w).pipe(x,x)):t(w)&&w.pipe(x,x);w=n(l.theme);D=b.extend(!0,D,w);this._style=b.extend(!0,{},u,D);i?this.throbber=new r(this._style):f&&(this.throbber=new o(this._style));this.throbber&&-1<l.percent&&this.throbber.setPercent(l.percent)}
var u="vml-root",s='<span class="indicator-throbber"></span><span class="indicator-message" {0}>{1}</span>',t=e.async.isPromise,c={throbber:["width","height"],"throbber-line":["width","color"]},i=!0,f=e.env.ua.isIE;b(function(){i=!!document.createElement("canvas").getContext;!i&&f&&(document.namespaces.add("v","urn:schemas-microsoft-com:vml"),document.createStyleSheet().cssText="v\\:stroke,v\\:line,v\\:textbox{behavior: url(#default#VML);}")});o.prototype={show:function(b){b&&(this.root=b,this.highlightPos=
1,this.hide(),this.root.appendChild(this.group),this._run())},hide:function(){this.root&&(this.root.innerHTML="",this._runId&&(clearTimeout(this._runId),this._runId=null))},_run:function(){for(var b=this.style.throbber.lines,c=this.style.throbber.roundTime,a=this.highlightPos,e=this.group.childNodes,f=0,i=e.length;f<i;f++){var g=e[f];if("textbox"!==g.nodeName){var k=f+1;g.firstChild.opacity=k==a?"1":k==a+1||k==a-1?"0.75":"0.4"}}a==b?a=0:a++;this.highlightPos=a;b=Math.floor(c/b);50>b&&(b=50);var l=
this;this._runId=setTimeout(function(){l._run.call(l)},b)},_createPercentArea:function(){var c=k("textbox"),d=b("<table><tr><td></td></tr></table>"),a=d.find("td");a.width(this.group.style.width);a.height(this.group.style.height);a.css("line-height",this.group.style.height);a.addClass("throbber-percent");c.appendChild(d[0]);this.group.appendChild(c)},setPercent:function(c){b(this.group).find(".throbber-percent").html(c)}};var r=function(c){this.style=b.extend(!0,{},c);this.canvas=document.createElement("canvas");
this.baseDiv=document.createElement("div");this.percentDiv=document.createElement("div");var c=this.canvas,d=this.baseDiv,a=this.percentDiv;c.width=this.style.throbber.width;c.height=this.style.throbber.height;c.style.display="block";c.style.position="absolute";d.style.width=this.style.throbber.width+"px";d.style.height=this.style.throbber.height+"px";d.appendChild(c);a.style.width=this.style.throbber.width+"px";a.style.height=this.style.throbber.height+"px";a.style.lineHeight=this.style.throbber.height+
"px";a.className="throbber-percent";d.appendChild(a);this.positions=g(c.width,this.style.throbber.lines)};r.prototype={show:function(b){b&&(this.root=b,this.highlightPos=1,this.hide(),b.appendChild(this.baseDiv),this._run())},hide:function(){this.root&&(this.root.innerHTML="",this._runId&&(clearTimeout(this._runId),this._runId=null))},_run:function(){var b=this.canvas,c=b.getContext("2d"),a=this.highlightPos,e=this.positions,f=this.style.throbberLine.color,i=this.style.throbberLine.width,g=this.style.throbber.lines,
k=this.style.throbber.roundTime;b.width=b.width;for(var b=0,l=e.length;b<l;b++){c.beginPath();c.strokeStyle=f;c.lineWidth=i;var o=b+1;c.globalAlpha=o==a?1:o==a+1||o==a-1?0.75:0.4;var n=e[b],o=n.from,n=n.to;c.moveTo(o.x,o.y);c.lineTo(n.x,n.y);c.stroke()}a==g?a=0:a++;this.highlightPos=a;c=Math.floor(k/g);50>c&&(c=50);var r=this;this._runId=setTimeout(function(){r._run.call(r)},c)},setPercent:function(b){this.percentDiv.innerHTML=b}};l.prototype={show:function(){var c=this._style,d=null;this._isGlobalBlockTarget()?
(b.blockUI(c),d=b("body").children(".blockUI."+c.blockMsgClass+".blockPage")):(d=b(this.target),d.block(c),d=d.children(".blockUI."+c.blockMsgClass+".blockElement"));this.throbber.show(d.children(".indicator-throbber")[0]);this._setPositionAndResizeWidth();return this},_setPositionAndResizeWidth:function(){var c=this._style,d=null,a=null,e=0;this._isGlobalBlockTarget()?(d=b("body"),a=d.children(".blockUI."+c.blockMsgClass+".blockPage"),a.css("top",(b(window).height()-a.outerHeight())/2+"px")):(d=
b(this.target),a=d.children(".blockUI."+c.blockMsgClass+".blockElement"),a.css("top",(d.height()-a.outerHeight())/2+"px"));c=a.innerWidth()-a.width();a.children().each(function(){e=e+b(this).outerWidth(true)});a.width(e+c);a.css("left",(d.width()-a.outerWidth())/2+"px")},_isGlobalBlockTarget:function(){return this.target===document||this.target===window||this.target===document.body},hide:function(){this._isGlobalBlockTarget()?b.unblockUI():b(this.target).unblock();return this},percent:function(b){"number"===
typeof b&&0<=b&&100>=b&&this.throbber.setPercent(b);return this},message:function(c){if("string"===typeof c){var d=this._style,a=null,a=this._isGlobalBlockTarget()?b("body").children(".blockUI."+d.blockMsgClass+".blockPage"):b(this.target).children(".blockUI."+d.blockMsgClass+".blockElement");a.children(".indicator-message").css("display","inline-block").text(c);this._setPositionAndResizeWidth()}return this}};e.u.obj.expose("h5.ui",{indicator:function(b,c){return new l(b,c)},isInView:function(c,d){var a,
f,i,g,k=b(c);if(void 0===d)f=e.env.ua.isiOS?window.innerHeight:b(window).height(),g=e.env.ua.isiOS?window.innerWidth:b(window).width(),a=b(window).scrollTop(),i=b(window).scrollLeft();else{g=b(d);if(0===g.find(k).length)return;a=g.offset().top+parseInt(g.css("border-top-width"));i=g.offset().left+parseInt(g.css("border-left-width"));f=g.innerHeight();g=g.innerWidth()}f=a+f;g=i+g;var l=k.offset().top,o=k.offset().left,n=l+k.outerHeight(),k=o+k.outerWidth();return(a<=l&&l<f||a<n&&n<=f)&&(i<=o&&o<g||
i<k&&k<=g)},scrollToTop:function(){function b(){1===window.scrollY&&(c=0);0<c&&(window.scrollTo(0,1),c--,setTimeout(b,a))}var c=3,a=500;window.scrollTo(0,1);1!==window.scrollY&&setTimeout(b,a)}})})();(function(){function n(){var c=b.mobile.activePage;if(c){var c=c.attr("id"),e=o[c];if(g[c]&&(!e||0===e.length))k.addCSS(c),k.bindController(c)}}e.log.createLogger("h5.ui.jqm.manager");var k=null,g={},o={},l={},u=[],s={};e.u.obj.ns("h5.ui.jqm");e.ui.jqm.dataPrefix="h5";var t={__name:"JQMController",__ready:function(){var c=
this;u.push(this.rootElement);b(':jqmData(role="page"), :jqmData(role="dialog")').each(function(){u.push(this);c.loadScript(this.id)})},':jqmData(role="page"), :jqmData(role="dialog") pageinit':function(b){b=b.event.target.id;this.loadScript(b);this.addCSS(b);this.bindController(b)},"{document} pageremove":function(b){var b=b.event.target.id,e=o[b];if(e){for(var f=0,g=e.length;f<g;f++)e[f].dispose();o[b]=[]}},"{document} pagebeforeshow":function(b){b=b.event.target.id;this.addCSS(b);for(var e in o)for(var f=
o[e],g=b===e,h=0,d=f.length;h<d;h++){var a=f[h];g?a.enableListeners():a.disableListeners()}},"{document} pagehide":function(b){this.removeCSS(b.event.target.id)},"* h5controllerbound":function(b){var e=b.event.target.id;o[e]||(o[e]=[]);o[e].push(b.evArg)},loadScript:function(c){var c=b("#"+c),g=b.trim(c.data(this.getDataAttribute("script")));if(0!==g.length)return g=b.map(g.split(","),function(c){return b.trim(c)}),c=!0==c.data(this.getDataAttribute("async")),e.u.loadScript(g,{async:c})},getDataAttribute:function(b){var g=
e.ui.jqm.dataPrefix;null==g&&(g="h5");return 0!==g.length?g+"-"+b:b},bindController:function(b){var i=o[b];g[b]&&!(i&&0<i.length)&&e.core.controller("#"+b,g[b],l[b])},addCSS:function(c){this.firstAddCSS&&(this.firstAddCSS=!1);var e=s[c];if(e)for(var f=document.getElementsByTagName("head")[0],g=f.getElementsByTagName("link"),h=g.length,e=w(e),d=0,e=e.length;d<e;d++){for(var a=b.mobile.path.parseUrl(s[c][d]).filename,k=!1,l=0;l<h;l++)if(b.mobile.path.parseUrl(g[l].href).filename===a){k=!0;break}k||
(a=document.createElement("link"),a.type="text/css",a.rel="stylesheet",a.href=s[c][d],f.appendChild(a))}},removeCSS:function(c){if(c=s[c]){var e=b.mobile.activePage.attr("id"),e=s[e],f=w(c),g=w(e);b("link").filter(function(){var c=b(this).attr("href");return-1!==b.inArray(c,f)&&-1===b.inArray(c,g)}).remove()}}};e.u.obj.expose("h5.ui.jqm.manager",{init:function(){b(function(){k||(k=e.core.controller(document.body,t));n()})},define:function(b,i,f,o){g[b]=f;l[b]=o;s[b]=w(i);!k?e.ui.jqm.manager.init():
n()}})})();(function(){function q(){o||(o=navigator.geolocation);return o}function k(b,e){this.oblateness=b;this.semiMajorAxis=e}function g(){}L({2E3:"正しい緯度または経度を指定して下さい。",2001:"正しい計算モード定数を指定して下さい",2002:"位置情報の取得に失敗しました。"});var o=null,l=e.env.ua;k.prototype.getOblateness=function(){return this.oblateness};k.prototype.getSemiMajorAxis=function(){return this.semiMajorAxis};var u=new k(298.257222,6378137),s=new k(299.152813,6377397.155),t=Math.PI/180;b.extend(g.prototype,{isSupported:l.isIE&&9<=l.browserVersion?
!0:!!q(),getCurrentPosition:function(b){var g=e.async.deferred();q().getCurrentPosition(function(b){g.resolve(b)},function(b){g.reject(J(2002,null,b))},b);return g.promise()},watchPosition:function(b){function g(){}var f=e.async.deferred(),k=q().watchPosition(function(b){f.notify(b)},function(b){f.reject(J(2002,null,b))},b);g.prototype.unwatch=function(){q().clearWatch(k);f.resolve()};return f.promise(new g)},getDistance:function(b,e,f,g,h){if(!isFinite(b)||!isFinite(e)||!isFinite(f)||!isFinite(g))throw new n(2E3);
var d=h?h:u;if(!(d instanceof k))throw new n(2001);var h=d.getSemiMajorAxis(),a=d.getOblateness(),b=b*t,e=e*t,f=f*t,d=g*t,g=(b+f)/2,a=Math.sqrt(2*a-1)/a,a=Math.pow(a,2),l=Math.sqrt(1-a*Math.pow(Math.sin(g),2)),a=h*(1-a)/Math.pow(l,3),h=h/l,e=e-d;return Math.sqrt(Math.pow(a*(b-f),2)+Math.pow(h*Math.cos(g)*e,2))},GS_GRS80:u,GS_BESSEL:s});e.u.obj.expose("h5.api",{geo:new g})})();(function(){function q(a){switch(a.code){case a.CONSTRAINT_ERR:return"一意制約に反しています。";case a.DATABASE_ERR:return"データベースエラー";
case a.QUOTA_ERR:return"空き容量が不足しています。";case a.SYNTAX_ERR:return"構文に誤りがあります。";case a.TIMEOUT_ERR:return"ロック要求がタイムアウトしました。";case a.TOO_LARGE_ERR:return"取得結果の行が多すぎます。";case a.UNKNOWN_ERR:return"トランザクション内で例外がスローされました。";case a.VERSION_ERR:return"データベースのバージョンが一致しません。";default:return""}}function k(a,b){for(var c=a._tasks,e=c.length-1;0<=e;e--){var d=c[e],f=q(b);d.deferred.reject(J(K,[f,b.message],b))}}function g(a){for(var a=a._tasks,b=a.length-1;0<=b;b--){var c=a[b];c.deferred.resolve(c.result)}}function o(a){if(a)throw new n(m);
}function l(a,b){if("string"!==typeof b)throw new n(z,a);}function u(a,b){if(b&&!(b instanceof c))throw new n(B,a);}function s(a,c,e){if(b.isPlainObject(a))for(var d in a){var f=d.replace(/ +/g," ").split(" "),g=[];if(!(0===f.length||""===f[0])){if(1===f.length)g.push(f[0]),g.push("="),g.push("?");else if(/^(<=|<|>=|>|=|!=|like)$/i.test(f[1]))3===f.length&&/^like$/i.test(f[1])?(g.push(f[0]),g.push(f[1]),g.push("?"),g.push("ESCAPE"),g.push('"'+f[2]+'"')):(g.push(f[0]),g.push(f[1]),g.push("?"));else throw new n(D);
c.push(g.join(" "));e.push(a[d])}}}function t(){}function c(a,b){this._db=a;this._tx=b;this._tasks=[]}function i(a,c,e){this._txw=a;this._tableName=c;this._columns=b.isArray(e)?e.join(", "):"*";this._statement=this._orderBy=this._where=null;this._params=[];this._df=G();this._executed=!1}function f(a,b,c){this._txw=a;this._tableName=b;this._values=c?w(c):[];this._statement=[];this._params=[];this._df=G();this._executed=!1}function r(a,b,c){this._txw=a;this._tableName=b;this._value=c;this._statement=
this._where=null;this._params=[];this._df=G();this._executed=!1}function h(a,b){this._txw=a;this._tableName=b;this._statement=this._where=null;this._params=[];this._df=G();this._executed=!1}function d(a,b,c){this._txw=a;this._statement=b;this._params=c||[];this._df=G();this._executed=!1}function a(a){this._txw=a;this._queue=[];this._df=G();this._executed=!1}function A(a){this._db=a}function E(){}var m=3E3,z=3001,B=3002,D=3003,K=3010,x={};x[m]="同一オブジェクトによるSQLの再実行はできません。";x[z]="{0}: テーブル名を指定して下さい。";
x[B]="{0}: トランザクションが不正です。";x[D]="オペレータが不正です。 <= < >= > = != like のいずれかを使用して下さい。";x[3004]="{0}: {1}に指定したオブジェクトの型が不正です。";x[3005]="{0}: カラム名を指定して下さい。";x[3006]="{0}: 値を指定して下さい。";x[3007]="{0}: ステートメントが不正です。";x[3008]="{0}: パラメータは配列で指定して下さい。";x[3009]="指定されたオブジェクトはトランザクションに追加できません。Insert/Update/Del/Select/Sqlクラスのインスタンスを指定して下さい。";x[K]="トランザクション処理中にエラーが発生しました。{0} {1}";L(x);var G=e.async.deferred;b.extend(c.prototype,{_runTransaction:function(){return null!=this._tx},_execute:function(a,b,c){this._runTransaction()?
this._tx.executeSql(a,b,c):this._db.transaction(a,b,c)},_addTask:function(a){this._tasks.push({deferred:a,result:null})},_setResult:function(a){this._tasks[this._tasks.length-1].result=a}});i.prototype=new t;b.extend(i.prototype,{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new n(3004,["Select","where"]);this._where=a;return this},orderBy:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new n(3004,["Select","orderBy"]);this._orderBy=w(a);return this},execute:function(){var a=
this,c=function(){var c=a._params,d=a._where,f=a._orderBy,g=e.u.str.format("SELECT {0} FROM {1}",a._columns,a._tableName);if(b.isPlainObject(d)){var h=[];s(d,h,c);g+=" WHERE "+h.join(" AND ")}else"string"===typeof d&&(g+=" WHERE "+d);b.isArray(f)&&(g+=" ORDER BY "+f.join(", "));a._statement=g},d=G(),f=this._txw,h=this._executed,i=null;f._runTransaction()?(f._addTask(d),c(),o(h),f._execute(this._statement,this._params,function(a,b){i=b.rows;f._setResult(i);d.notify(i,f)})):f._execute(function(b){f._addTask(d);
c();o(h);f._tx=b;b.executeSql(a._statement,a._params,function(a,b){i=b.rows;f._setResult(i);d.notify(i,f)})},function(a){k(f,a)},function(){g(f)});this._executed=!0;return d.promise()}});f.prototype=new t;b.extend(f.prototype,{execute:function(){function a(){c._statement.length===n?(l=m,h._setResult(l),f.notify(l,h)):h._execute(c._statement[n],c._params[n],function(b,c){n++;m.push(c.insertId);a()})}var c=this,d=function(){var a=c._values;if(0===a.length)c._statement.push(e.u.str.format("INSERT INTO {0} DEFAULT VALUES",
c._tableName)),c._params.push([]);else for(var d=0,f=a.length;d<f;d++){var g=a[d];if(g){if(b.isPlainObject(g)){var j=[],h=[],i=[],k;for(k in g)g.hasOwnProperty(k)&&(j.push("?"),h.push(k),i.push(g[k]));c._statement.push(e.u.str.format("INSERT INTO {0} ({1}) VALUES ({2})",c._tableName,h.join(", "),j.join(", ")));c._params.push(i)}}else c._statement.push(e.u.str.format("INSERT INTO {0} DEFAULT VALUES",c._tableName)),c._params.push([])}},f=G(),h=this._txw,i=this._executed,l=null,m=[],n=0;h._runTransaction()?
(h._addTask(f),d(),o(i),a()):h._execute(function(b){h._addTask(f);d();o(i);h._tx=b;a()},function(a){k(h,a)},function(){g(h)});this._executed=!0;return f.promise()}});r.prototype=new t;b.extend(r.prototype,{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new n(3004,["Update","where"]);this._where=a;return this},execute:function(){var a=this,c=function(){var c=a._where,d=a._value,f=[],g;for(g in d)d.hasOwnProperty(g)&&(f.push(g+" = ?"),a._params.push(d[g]));a._statement=e.u.str.format("UPDATE {0} SET {1}",
a._tableName,f.join(", "));b.isPlainObject(c)?(d=[],s(c,d,a._params),a._statement+=" WHERE "+d.join(" AND ")):"string"===typeof c&&(a._statement+=" WHERE "+c)},d=G(),f=this._txw,h=this._executed,i=null;f._runTransaction()?(f._addTask(d),c(),o(h),f._execute(this._statement,this._params,function(a,b){i=b.rowsAffected;f._setResult(i);d.notify(i,f)})):f._execute(function(b){f._addTask(d);c();o(h);f._tx=b;b.executeSql(a._statement,a._params,function(a,b){i=b.rowsAffected;f._setResult(i);d.notify(i,f)})},
function(a){k(f,a)},function(){g(f)});this._executed=!0;return d.promise()}});h.prototype=new t;b.extend(h.prototype,{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new n(3004,["Del","where"]);this._where=a;return this},execute:function(){var a=this,c=function(){var c=a._where;a._statement=e.u.str.format("DELETE FROM {0}",a._tableName);if(b.isPlainObject(c)){var d=[];s(c,d,a._params);a._statement+=" WHERE "+d.join(" AND ")}else"string"===typeof c&&(a._statement+=" WHERE "+c)},
d=G(),f=this._txw,h=this._executed,i=null;f._runTransaction()?(f._addTask(d),c(),o(h),f._execute(this._statement,this._params,function(a,b){i=b.rowsAffected;f._setResult(i);d.notify(i,f)})):f._execute(function(b){f._addTask(d);c();o(h);f._tx=b;b.executeSql(a._statement,a._params,function(a,b){i=b.rowsAffected;f._setResult(i);d.notify(i,f)})},function(a){k(f,a)},function(){g(f)});return d.promise()}});d.prototype=new t;b.extend(d.prototype,{execute:function(){var a=G(),b=this._txw,c=this._executed,
d=this._statement,e=this._params,f=null;b._runTransaction()?(b._addTask(a),o(c),b._execute(d,e,function(c,d){f=d;b._setResult(f);a.notify(f,b)})):b._execute(function(g){b._addTask(a);o(c);b._tx=g;g.executeSql(d,e,function(c,d){f=d;b._setResult(f);a.notify(f,b)})},function(a){k(b,a)},function(){g(b)});this._executed=!0;return a.promise()}});a.prototype=new t;b.extend(a.prototype,{add:function(a){if(!(a instanceof t))throw new n(3009);this._queue.push(a);return this},execute:function(){function a(b){function d(a){this._txw=
new c(null,a)}for(var e=[],g=0,h=f.length;g<h;g++)d.prototype=f[g],e.push(new d(b));return e}function b(){if(l.length===i){for(var a=[],c=0,f=l.length;c<f;c++)a.push(l[c]._txw._tasks[0].result);e._setResult(a);d.notify(a,e)}else l[i].execute().progress(function(){i++;b()})}var d=this._df,e=this._txw,f=this._queue,h=this._executed,i=0,l=null;e._runTransaction()?(e._addTask(d),o(h),l=a(e._tx),b()):e._execute(function(c){e._addTask(d);o(h);l=a(c);e._tx=c;b()},function(a){k(e,a)},function(){g(e)});this._executed=
!0;return d.promise()},promise:function(){return this._df.promise()}});b.extend(A.prototype,{select:function(a,d,e){l("select",a);u("select",e);if(!b.isArray(d)&&"*"!==d)throw new n(3005,"select");return new i(e?e:new c(this._db,null),a,d)},insert:function(a,d,e){l("insert",a);u("insert",e);if(d&&!b.isArray(d)&&!b.isPlainObject(d))throw new n(3006,"insert");return new f(e?e:new c(this._db,null),a,d)},update:function(a,d,e){l("update",a);u("update",e);if(!b.isPlainObject(d))throw new n(3006,"update");
return new r(e?e:new c(this._db,null),a,d)},del:function(a,b){l("del",a);u("del",b);return new h(b?b:new c(this._db,null),a)},sql:function(a,e,f){u("sql",f);if("string"!==typeof a)throw new n(3007,"sql");if(e&&!b.isArray(e))throw new n(3008,"sql");return new d(f?f:new c(this._db,null),a,e)},transaction:function(b){u("sql",b);return new a(b?b:new c(this._db,null))}});b.extend(E.prototype,{isSupported:!!window.openDatabase,open:function(a,b,c,d){if(this.isSupported)return a=openDatabase(a,b,c,d),new A(a)}});
e.u.obj.expose("h5.api",{sqldb:new E})})();(function(){function n(b){this._storage=b}e.log.createLogger("h5.api.storage");b.extend(n.prototype,{getLength:function(){return this._storage.length},key:function(b){return this._storage.key(b)},getItem:function(b){return e.u.obj.deserialize(this._storage.getItem(b))},setItem:function(b,g){this._storage.setItem(b,e.u.obj.serialize(g))},removeItem:function(b){this._storage.removeItem(b)},clear:function(){this._storage.clear()},each:function(b){for(var e=
this._storage,n=0,l=e.length;n<l;n++){var q=e.key(n);b(n,q,this.getItem(q))}}});e.u.obj.expose("h5.api.storage",{isSupported:!!window.localStorage,local:new n(window.localStorage),session:new n(window.sessionStorage)})})();(function(){function n(b){b=b||{};b.timestamp=b.timestamp||(new Date).getTime();var c=b.coords?b.coords:b;b.coords={latitude:c.latitude||0,longitude:c.longitude||0,accuracy:c.accuracy||0,altitude:c.altitude||null,altitudeAccuracy:c.altitudeAccuracy||null,heading:c.heading||null,
speed:c.speed||null};return b}function k(){this.PERMISSION_DENIED=1;this.POSITION_UNAVALABLE=2;this.TIMEOUT=3}function g(){}if(e){var o={},l=[],u=0,s=null,t=0;o.getCurrentPosition=e.api.geo.getCurrentPosition;o.watchPosition=e.api.geo.watchPosition;k.prototype.code=1;k.prototype.message="";b.extend(g.prototype,{forceError:!1,watchIntervalTime:1E3,dummyPositions:[]});var c=new g;b.extend(e.api.geo,{getCurrentPosition:function(c){var f=e.async.deferred();if(e.dev.api.geo.forceError)return setTimeout(function(){f.reject({code:"forceError"})},
0),f.promise();var g=e.dev.api.geo.dummyPositions;if(!g||0===g.length)return o.getCurrentPosition(c);g=b.isArray(e.dev.api.geo.dummyPositions)?e.dev.api.geo.dummyPositions:[e.dev.api.geo.dummyPositions];setTimeout(function(){0<g.length?f.resolve(n(g[0])):f.reject({code:(new k).POSITION_UNAVALABLE})},0);return f.promise()},watchPosition:function(c){var f=e.async.deferred();if(e.dev.api.geo.forceError)return setTimeout(function(){f.reject({code:"forceError"})},0),f.promise();var g=b.isArray(e.dev.api.geo.dummyPositions)?
e.dev.api.geo.dummyPositions:[e.dev.api.geo.dummyPositions].slice(0);if(0===g.length)return o.watchPosition(c);var h=u++,c=function(){};c.prototype={unwatch:function(){l[h]&&(l[h].resolve(),delete l[h],setTimeout(function(){b.isEmptyObject(l)&&(clearInterval(s),s=null,t=0)},0))}};setTimeout(function(){if(0<g.length){if(l[h]=f,null===s){var b=function(){var a;a=t>=g.length?g[g.length-1]:g[t++];for(var b in l)l[b].notify(n(a))};b();s=setInterval(b,e.dev.api.geo.watchIntervalTime)}}else f.reject({code:(new k).POSITION_UNAVALABLE})},
0);return f.promise(new c(h))}});e.u.obj.expose("h5.dev.api.geo",c)}})();e.log.createLogger("h5")})(jQuery);
